(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{uWqz:function(e,r,c){"use strict";c.r(r),c.d(r,"CoreSearchLazyModule",(function(){return w}));var a=c("L3Fv"),o=c("fXoL"),t=c("tyNb"),l=c("mrSG"),s=c("3LXp"),n=c("7otd"),i=c("9+EE"),u=c("bFG1"),h=c("D7J2"),d=c("j3ag"),_=c("mvS9"),S=c("fjkH"),b=c("9CLO"),g=c("pHTc"),p=c("9zps"),m=c("TEn/"),f=c("ofXK"),y=c("C1x5"),C=c("nt/U"),v=c("xpMl"),P=c("yNDK"),E=c("3CSS"),G=c("hMzs"),D=c("pz8D"),M=c("r8G5"),T=c("sYmb");function CoreSearchGlobalSearchPage_h1_6_Template(e,r){1&e&&(o.Ec(0,"h1"),o.pd(1),o.Pc(2,"translate"),o.Dc()),2&e&&(o.lc(1),o.qd(o.Qc(2,1,"core.search")))}function CoreSearchGlobalSearchPage_h1_7_Template(e,r){1&e&&(o.Ec(0,"h1"),o.pd(1),o.Pc(2,"translate"),o.Dc()),2&e&&(o.lc(1),o.qd(o.Qc(2,1,"core.search.globalsearch")))}function CoreSearchGlobalSearchPage_ion_card_12_Template(e,r){if(1&e&&(o.Ec(0,"ion-card",12),o.Ec(1,"ion-item"),o.zc(2,"ion-icon",13),o.Ec(3,"ion-label"),o.zc(4,"core-format-text",1),o.Dc(),o.Dc(),o.Dc()),2&e){const e=o.Oc();o.lc(4),o.Vc("text",e.searchBanner)}}function CoreSearchGlobalSearchPage_ion_list_16_core_search_global_search_result_1_Template(e,r){if(1&e){const e=o.Fc();o.Ec(0,"core-search-global-search-result",15),o.Mc("onClick",(function CoreSearchGlobalSearchPage_ion_list_16_core_search_global_search_result_1_Template_core_search_global_search_result_onClick_0_listener(){o.fd(e);const c=r.$implicit;return o.Oc(2).visitResult(c)})),o.Dc()}if(2&e){o.Vc("result",r.$implicit)}}function CoreSearchGlobalSearchPage_ion_list_16_Template(e,r){if(1&e&&(o.Ec(0,"ion-list"),o.nd(1,CoreSearchGlobalSearchPage_ion_list_16_core_search_global_search_result_1_Template,1,1,"core-search-global-search-result",14),o.Dc()),2&e){const e=o.Oc();o.lc(1),o.Vc("ngForOf",e.resultsSource.getItems())}}function CoreSearchGlobalSearchPage_core_empty_box_18_p_1_Template(e,r){1&e&&(o.Ec(0,"p"),o.pd(1),o.Pc(2,"translate"),o.Dc()),2&e&&(o.lc(1),o.qd(o.Qc(2,1,"core.search.empty")))}const _c0=function(e){return{$a:e}};function CoreSearchGlobalSearchPage_core_empty_box_18_ng_container_2_Template(e,r){if(1&e&&(o.Cc(0),o.Ec(1,"p"),o.Ec(2,"strong"),o.pd(3),o.Pc(4,"translate"),o.Dc(),o.Dc(),o.Ec(5,"p"),o.Ec(6,"small"),o.pd(7),o.Pc(8,"translate"),o.Dc(),o.Dc(),o.Bc()),2&e){const e=o.Oc(2);o.lc(3),o.qd(o.Rc(4,2,"core.search.noresults",o.ad(7,_c0,e.resultsSource.getQuery()))),o.lc(4),o.qd(o.Qc(8,5,"core.search.noresultshelp"))}}function CoreSearchGlobalSearchPage_core_empty_box_18_Template(e,r){if(1&e&&(o.Ec(0,"core-empty-box",16),o.nd(1,CoreSearchGlobalSearchPage_core_empty_box_18_p_1_Template,3,3,"p",2),o.nd(2,CoreSearchGlobalSearchPage_core_empty_box_18_ng_container_2_Template,9,9,"ng-container",2),o.Dc()),2&e){const e=o.Oc();o.Vc("dimmed",!e.resultsSource.isLoaded()),o.lc(1),o.Vc("ngIf",!e.resultsSource.isLoaded()),o.lc(1),o.Vc("ngIf",e.resultsSource.isLoaded())}}let x=(()=>{class CoreSearchGlobalSearchPage{constructor(){this.courseId=null,this.loadMoreError=null,this.searchBanner=null,this.resultsSource=new n.a("",{})}ngOnInit(){var e,r,c,a;const o=i.c.getRequiredCurrentSite(),t=null!==(c=null===(r=null===(e=o.config)||void 0===e?void 0:e.searchbanner)||void 0===r?void 0:r.trim())&&void 0!==c?c:"",l=g.a.getRouteNumberParam("courseId");u.a.isTrueOrOne(null===(a=o.config)||void 0===a?void 0:a.searchbannerenable)&&t.length>0&&(this.searchBanner=t),l&&(this.courseId=l,this.resultsSource.setFilters({courseIds:[l]})),this.filtersObserver=S.b.on(b.a,(e=>this.resultsSource.setFilters(e)))}ngAfterViewInit(){const e=g.a.getRouteParam("query");e&&(this.searchBox&&(this.searchBox.searchText=e),this.search(e))}ngOnDestroy(){var e;null===(e=this.filtersObserver)||void 0===e?void 0:e.off()}search(e){return Object(l.a)(this,void 0,void 0,(function*(){this.resultsSource.setQuery(e),this.resultsSource.hasEmptyQuery()||(yield s.a.showOperationModals("core.searching",!0,(()=>Object(l.a)(this,void 0,void 0,(function*(){yield this.resultsSource.reload(),yield u.a.ignoreErrors(b.c.logViewResults(this.resultsSource.getQuery(),this.resultsSource.getFilters())),h.a.logEvent({type:h.b.VIEW_ITEM_LIST,ws:"core_search_view_results",name:d.I.instant("core.search.globalsearch"),data:{query:e,filters:JSON.stringify(this.resultsSource.getFilters())},url:_.a.addParamsToUrl("/search/index.php",{q:e})})})))))}))}clearSearch(){this.loadMoreError=null,this.resultsSource.setQuery(""),this.resultsSource.reset()}openFilters(){return Object(l.a)(this,void 0,void 0,(function*(){const{CoreSearchGlobalSearchFiltersComponent:e}=yield c.e(83).then(c.bind(null,"BkwX"));yield s.a.openSideModal({component:e,componentProps:{hideCourses:!!this.courseId,filters:this.resultsSource.getFilters()}}),!this.resultsSource.hasEmptyQuery()&&this.resultsSource.isDirty()&&(yield s.a.showOperationModals("core.searching",!0,(()=>this.resultsSource.reload())))}))}visitResult(e){return Object(l.a)(this,void 0,void 0,(function*(){yield i.c.visitLink(e.url)}))}loadMoreResults(e){var r;return Object(l.a)(this,void 0,void 0,(function*(){try{yield null===(r=this.resultsSource)||void 0===r?void 0:r.load()}catch(e){this.loadMoreError=s.a.getErrorMessage(e)}finally{e()}}))}}return CoreSearchGlobalSearchPage.ɵfac=function CoreSearchGlobalSearchPage_Factory(e){return new(e||CoreSearchGlobalSearchPage)},CoreSearchGlobalSearchPage.ɵcmp=o.sc({type:CoreSearchGlobalSearchPage,selectors:[["page-core-search-global-search"]],viewQuery:function CoreSearchGlobalSearchPage_Query(e,r){var c;(1&e&&o.ud(p.a,!0),2&e)&&(o.dd(c=o.Nc())&&(r.searchBox=c.first))},decls:23,vars:20,consts:[["slot","start"],[3,"text"],[4,"ngIf"],["slot","end"],[1,"limited-width"],["class","core-danger-card",4,"ngIf"],["searchArea","CoreSearchGlobalSearch",3,"placeholder","searchLabel","autoFocus","onSubmit","onClear"],[3,"enabled","error","action"],["icon","fas-magnifying-glass",3,"dimmed",4,"ngIf"],["slot","fixed","core-fab","","vertical","bottom","horizontal","end"],[3,"click"],["name","fas-filter","aria-hidden","true"],[1,"core-danger-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[3,"result","onClick",4,"ngFor","ngForOf"],[3,"result","onClick"],["icon","fas-magnifying-glass",3,"dimmed"]],template:function CoreSearchGlobalSearchPage_Template(e,r){1&e&&(o.Ec(0,"ion-header"),o.Ec(1,"ion-toolbar"),o.Ec(2,"ion-buttons",0),o.zc(3,"ion-back-button",1),o.Pc(4,"translate"),o.Dc(),o.Ec(5,"ion-title"),o.nd(6,CoreSearchGlobalSearchPage_h1_6_Template,3,3,"h1",2),o.nd(7,CoreSearchGlobalSearchPage_h1_7_Template,3,3,"h1",2),o.Dc(),o.Ec(8,"ion-buttons",3),o.zc(9,"core-user-menu-button"),o.Dc(),o.Dc(),o.Dc(),o.Ec(10,"ion-content",4),o.Ec(11,"div"),o.nd(12,CoreSearchGlobalSearchPage_ion_card_12_Template,5,1,"ion-card",5),o.Ec(13,"core-search-box",6),o.Mc("onSubmit",(function CoreSearchGlobalSearchPage_Template_core_search_box_onSubmit_13_listener(e){return r.search(e)}))("onClear",(function CoreSearchGlobalSearchPage_Template_core_search_box_onClear_13_listener(){return r.clearSearch()})),o.Pc(14,"translate"),o.Pc(15,"translate"),o.Dc(),o.nd(16,CoreSearchGlobalSearchPage_ion_list_16_Template,2,1,"ion-list",2),o.Ec(17,"core-infinite-loading",7),o.Mc("action",(function CoreSearchGlobalSearchPage_Template_core_infinite_loading_action_17_listener(e){return r.loadMoreResults(e)})),o.Dc(),o.nd(18,CoreSearchGlobalSearchPage_core_empty_box_18_Template,3,3,"core-empty-box",8),o.Ec(19,"ion-fab",9),o.Ec(20,"ion-fab-button",10),o.Mc("click",(function CoreSearchGlobalSearchPage_Template_ion_fab_button_click_20_listener(){return r.openFilters()})),o.Pc(21,"translate"),o.zc(22,"ion-icon",11),o.Dc(),o.Dc(),o.Dc(),o.Dc()),2&e&&(o.lc(3),o.Vc("text",o.Qc(4,12,"core.back")),o.lc(3),o.Vc("ngIf",r.courseId),o.lc(1),o.Vc("ngIf",!r.courseId),o.lc(5),o.Vc("ngIf",r.searchBanner),o.lc(1),o.Vc("placeholder",o.Qc(14,14,"core.search"))("searchLabel",o.Qc(15,16,"core.search"))("autoFocus",!0),o.lc(3),o.Vc("ngIf",r.resultsSource.isLoaded()),o.lc(1),o.Vc("enabled",r.resultsSource.isLoaded()&&!r.resultsSource.isCompleted())("error",r.loadMoreError),o.lc(1),o.Vc("ngIf",r.resultsSource.isEmpty()),o.lc(2),o.mc("aria-label",o.Qc(21,18,"core.filter")))},directives:[m.C,m.Ab,m.m,m.h,m.i,m.yb,f.t,y.a,C.a,m.v,p.a,v.a,m.x,P.a,m.y,m.D,E.a,m.n,m.I,m.O,G.a,m.P,f.s,D.a,M.a],pipes:[T.d],encapsulation:2}),CoreSearchGlobalSearchPage})();var I=c("PM4H"),O=c("dQ3M"),L=c("wG2S");function buildRoutes(e){return Object(L.b)(e,{component:x})}let w=(()=>{class CoreSearchLazyModule{}return CoreSearchLazyModule.ɵmod=o.wc({type:CoreSearchLazyModule}),CoreSearchLazyModule.ɵinj=o.vc({factory:function CoreSearchLazyModule_Factory(e){return new(e||CoreSearchLazyModule)},providers:[{provide:t.g,multi:!0,deps:[o.x],useFactory:buildRoutes}],imports:[[a.a,I.a,O.a],t.m]}),CoreSearchLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&o.kd(w,{declarations:[x],imports:[a.a,I.a,O.a],exports:[t.m]}))}}]);