(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{OzlW:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t("L3Fv"),o=t("wxbA"),a=t("fXoL");let c=(()=>{class CoreGradesCoursePageModule{}return CoreGradesCoursePageModule.ɵmod=a.wc({type:CoreGradesCoursePageModule}),CoreGradesCoursePageModule.ɵinj=a.vc({factory:function CoreGradesCoursePageModule_Factory(e){return new(e||CoreGradesCoursePageModule)},imports:[[r.a]]}),CoreGradesCoursePageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&a.kd(c,{declarations:[o.a],imports:[r.a]}))},eoiU:function(e,n,t){"use strict";t.d(n,"a",(function(){return CoreSwipeNavigationItemsManager}));var r=t("mrSG"),o=t("pHTc"),a=t("CtbY");class CoreSwipeNavigationItemsManager extends a.a{start(){return Object(r.a)(this,void 0,void 0,(function*(){this.updateSelectedItem()}))}navigateToNextItem(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(1,"forward")}))}navigateToPreviousItem(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(-1,"back")}))}hasNextItem(){return Object(r.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(1))}))}hasPreviousItem(){return Object(r.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(-1))}))}getCurrentPageRoute(){return o.a.getCurrentRoute()}getSelectedItemPathFromRoute(e){const n=[];for(;e&&(n.push(...e.url),e.firstChild);)e=e.firstChild;return n.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,n){return Object(r.a)(this,void 0,void 0,(function*(){const t=yield this.getItemBy(e);t&&(yield this.navigateToItem(t,{animationDirection:n,replace:!0}))}))}getItemBy(e){var n;return Object(r.a)(this,void 0,void 0,(function*(){const t=this.getSource().getItems(),r=null!==(n=this.selectedItem&&(null==t?void 0:t.indexOf(this.selectedItem)))&&void 0!==n?n:-1;if(-1===r||null===t)return null;const o=e>0?1:-1;let a=r,c=0;for(;c!==e;){if(a+=o,a<0)return null;if(a>=t.length)break;this.skipItemInSwipe(t[a])||(c+=o)}return c===e?t[a]:this.getSource().isCompleted()?null:(yield this.getSource().load(),this.getItemBy(e))}))}skipItemInSwipe(e){return!1}}},"q5/S":function(e,n,t){"use strict";t.d(n,"a",(function(){return CoreGradesCoursesSource}));var r=t("mrSG"),o=t("CvRw"),a=t("wo9T"),c=t("FvYb");class CoreGradesCoursesSource extends o.a{loadPageItems(){return Object(r.a)(this,void 0,void 0,(function*(){const e=yield a.a.getCoursesGrades();return{items:yield c.a.getGradesCourseData(e)}}))}getItemPath(e){return e.courseid.toString()}}},wxbA:function(e,n,t){"use strict";t.d(n,"a",(function(){return S}));var r=t("mrSG"),o=t("3LXp"),a=t("wo9T"),c=t("FvYb"),i=t("9+EE"),_=t("bFG1"),d=t("pHTc"),s=t("Y+03"),g=t("j3ag"),l=t("eoiU"),u=t("baaQ"),m=t("xtzZ"),p=t("q5/S"),C=t("6s78"),h=t("8vmT"),P=t("D7J2"),b=t("fXoL"),v=t("tyNb"),f=t("TEn/"),O=t("nt/U"),M=t("OZH1"),w=t("PgjG"),I=t("ofXK"),x=t("r8G5"),G=t("xpMl"),T=t("saTE"),y=t("3CSS"),E=t("eAud"),V=t("hMzs"),k=t("edOc"),D=t("sYmb");function CoreGradesCoursePage_core_empty_box_13_Template(e,n){1&e&&(b.zc(0,"core-empty-box",8),b.Pc(1,"translate")),2&e&&b.Vc("message",b.Qc(1,1,"core.grades.nogradesreturned"))}function CoreGradesCoursePage_div_14_th_4_Template(e,n){if(1&e&&(b.Ec(0,"th",14),b.pd(1),b.Pc(2,"translate"),b.Dc()),2&e){const e=n.$implicit;b.qc("ion-hide-md-down",e.hiddenPhone),b.Wc("id",e.name),b.mc("colspan",e.colspan),b.lc(1),b.rd(" ",b.Qc(2,5,"core.grades."+e.name)," ")}}function CoreGradesCoursePage_div_14_ng_container_6_tr_1_Template(e,n){if(1&e&&(b.Ec(0,"tr"),b.zc(1,"td",18),b.Dc()),2&e){const e=b.Oc().$implicit;b.lc(1),b.mc("rowspan",e.rowspan)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_td_1_Template(e,n){if(1&e&&b.zc(0,"td",27),2&e){const e=b.Oc(3).$implicit;b.mc("rowspan",e.rowspan)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_3_Template(e,n){if(1&e&&b.zc(0,"ion-icon",28),2&e){const e=b.Oc(3).$implicit;b.qc("expandable-status-icon-expanded",e.expanded)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_4_Template(e,n){if(1&e&&b.zc(0,"ion-icon",29),2&e){const e=b.Oc(3).$implicit;b.Wc("name",e.icon),b.mc("aria-label",e.iconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_img_5_Template(e,n){if(1&e&&b.zc(0,"img",30),2&e){const e=b.Oc(3).$implicit;b.Vc("src",e.image,b.id)("alt",e.iconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_core_mod_icon_6_Template(e,n){if(1&e&&b.zc(0,"core-mod-icon",31),2&e){const e=b.Oc(3).$implicit;b.Vc("modicon",e.image)("modname",e.itemmodule)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_1_Template(e,n){if(1&e&&b.zc(0,"td",26),2&e){const e=b.Oc().$implicit,n=b.Oc(4).$implicit;b.nc("ion-text-start core-grades-table-"+e.name),b.qc("ion-hide-md-down",e.hiddenPhone),b.Vc("innerHTML",n[e.name],b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_2_Template(e,n){if(1&e&&(b.Ec(0,"td",35),b.zc(1,"core-format-text",36),b.Dc()),2&e){const e=b.Oc().$implicit,n=b.Oc(4).$implicit,t=b.Oc(2);b.qc("ion-hide-md-down",e.hiddenPhone),b.lc(1),b.Vc("text",n.feedback)("contextInstanceId",t.courseId)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_ion_icon_1_Template(e,n){if(1&e&&b.zc(0,"ion-icon",38),2&e){const e=b.Oc(6).$implicit;b.Vc("name",e.gradeIcon),b.mc("aria-label",e.gradeIconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_Template(e,n){if(1&e&&(b.Ec(0,"td"),b.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_ion_icon_1_Template,1,2,"ion-icon",37),b.zc(2,"span",26),b.Dc()),2&e){const e=b.Oc().$implicit,n=b.Oc(4).$implicit;b.oc("ion-text-start core-grades-table-grade ",n.gradeClass,""),b.qc("ion-hide-md-down",e.hiddenPhone),b.lc(1),b.Vc("ngIf",n.gradeIcon),b.lc(1),b.Vc("innerHTML",n[e.name],b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_Template(e,n){if(1&e&&(b.Cc(0),b.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_1_Template,1,5,"td",32),b.nd(2,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_2_Template,2,4,"td",33),b.nd(3,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_Template,3,7,"td",34),b.Bc()),2&e){const e=n.$implicit,t=b.Oc(4).$implicit;b.lc(1),b.Vc("ngIf","gradeitem"!==e.name&&"feedback"!==e.name&&"grade"!==e.name&&void 0!==t[e.name]),b.lc(1),b.Vc("ngIf","feedback"===e.name&&void 0!==t.feedback),b.lc(1),b.Vc("ngIf","grade"===e.name)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_Template(e,n){if(1&e&&(b.Cc(0),b.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_Template,4,3,"ng-container",12),b.Bc()),2&e){const e=b.Oc(5);b.lc(1),b.Vc("ngForOf",e.columns)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_Template(e,n){if(1&e&&(b.Cc(0),b.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_td_1_Template,1,1,"td",20),b.Ec(2,"th",21),b.nd(3,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_3_Template,1,2,"ion-icon",22),b.nd(4,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_4_Template,1,2,"ion-icon",23),b.nd(5,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_img_5_Template,1,2,"img",24),b.nd(6,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_core_mod_icon_6_Template,1,2,"core-mod-icon",25),b.zc(7,"span",26),b.Dc(),b.nd(8,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_Template,2,1,"ng-container",15),b.Bc()),2&e){const e=b.Oc(2).$implicit,n=b.Oc(2);b.lc(1),b.Vc("ngIf","category"==e.itemtype),b.lc(1),b.mc("colspan",e.colspan),b.lc(1),b.Vc("ngIf",e.expandable&&n.showSummary),b.lc(1),b.Vc("ngIf",e.icon),b.lc(1),b.Vc("ngIf",e.image&&!e.itemmodule),b.lc(1),b.Vc("ngIf",e.image&&e.itemmodule),b.lc(1),b.Vc("innerHTML",e.gradeitem,b.gd),b.lc(1),b.Vc("ngIf","category"!==e.itemtype)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template(e,n){if(1&e){const e=b.Fc();b.Ec(0,"tr",19),b.Mc("ariaButtonClick",(function CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template_tr_ariaButtonClick_0_listener(){b.fd(e);const n=b.Oc().$implicit,t=b.Oc(2);return n.expandable&&t.showSummary&&t.toggleRow(n)})),b.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_Template,9,8,"ng-container",15),b.Dc()}if(2&e){const e=b.Oc().$implicit,n=b.Oc(2);b.nc(e.rowclass),b.qc("core-grades-grade-clickable",e.expandable&&n.showSummary),b.Vc("id","grade-"+e.id),b.mc("role",e.expandable&&n.showSummary?"button row":"row")("tabindex",e.expandable&&n.showSummary&&0)("aria-expanded",e.expanded)("aria-label",n.rowAriaLabel(e))("aria-controls",e.detailsid),b.lc(1),b.Vc("ngIf",e.itemtype)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_3_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.zc(5,"p",26),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit;b.lc(3),b.qd(b.Qc(4,2,"core.grades.weight")),b.lc(2),b.Vc("innerHTML",e.weight,b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_4_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.zc(5,"p",26),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit;b.lc(3),b.qd(b.Qc(4,2,"core.grades.grade")),b.lc(2),b.Vc("innerHTML",e.grade,b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_5_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.zc(5,"p",26),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit;b.lc(3),b.qd(b.Qc(4,2,"core.grades.range")),b.lc(2),b.Vc("innerHTML",e.range,b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_6_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.zc(5,"p",26),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit;b.lc(3),b.qd(b.Qc(4,2,"core.grades.percentage")),b.lc(2),b.Vc("innerHTML",e.percentage,b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_7_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.zc(5,"p",26),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit;b.lc(3),b.qd(b.Qc(4,2,"core.grades.lettergrade")),b.lc(2),b.Vc("innerHTML",e.lettergrade,b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_8_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.zc(5,"p",26),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit;b.lc(3),b.qd(b.Qc(4,2,"core.grades.rank")),b.lc(2),b.Vc("innerHTML",e.rank,b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_9_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.zc(5,"p",26),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit;b.lc(3),b.qd(b.Qc(4,2,"core.grades.average")),b.lc(2),b.Vc("innerHTML",e.average,b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_10_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.Ec(5,"p"),b.zc(6,"core-format-text",36),b.Dc(),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit,n=b.Oc(2);b.lc(3),b.qd(b.Qc(4,3,"core.grades.feedback")),b.lc(3),b.Vc("text",e.feedback)("contextInstanceId",n.courseId)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_11_Template(e,n){if(1&e&&(b.Ec(0,"ion-item",41),b.Ec(1,"ion-label"),b.Ec(2,"p",42),b.pd(3),b.Pc(4,"translate"),b.Dc(),b.zc(5,"p",26),b.Dc(),b.Dc()),2&e){const e=b.Oc(2).$implicit;b.lc(3),b.qd(b.Qc(4,2,"core.grades.contributiontocoursetotal")),b.lc(2),b.Vc("innerHTML",e.contributiontocoursetotal,b.gd)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_Template(e,n){if(1&e&&(b.Ec(0,"tr",39),b.Ec(1,"td"),b.Ec(2,"ion-list"),b.nd(3,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_3_Template,6,4,"ion-item",40),b.nd(4,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_4_Template,6,4,"ion-item",40),b.nd(5,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_5_Template,6,4,"ion-item",40),b.nd(6,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_6_Template,6,4,"ion-item",40),b.nd(7,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_7_Template,6,4,"ion-item",40),b.nd(8,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_8_Template,6,4,"ion-item",40),b.nd(9,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_9_Template,6,4,"ion-item",40),b.nd(10,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_10_Template,7,5,"ion-item",40),b.nd(11,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_11_Template,6,4,"ion-item",40),b.Dc(),b.Dc(),b.Dc()),2&e){const e=b.Oc().$implicit,n=b.Oc(2);b.nc(e.rowclass),b.Vc("id",e.detailsid),b.lc(1),b.mc("colspan",n.totalColumnsSpan),b.lc(2),b.Vc("ngIf",e.weight),b.lc(1),b.Vc("ngIf",e.grade),b.lc(1),b.Vc("ngIf",e.range),b.lc(1),b.Vc("ngIf",e.percentage),b.lc(1),b.Vc("ngIf",e.lettergrade),b.lc(1),b.Vc("ngIf",e.rank),b.lc(1),b.Vc("ngIf",e.average),b.lc(1),b.Vc("ngIf",e.feedback),b.lc(1),b.Vc("ngIf",e.contributiontocoursetotal)}}function CoreGradesCoursePage_div_14_ng_container_6_Template(e,n){if(1&e&&(b.Cc(0),b.nd(1,CoreGradesCoursePage_div_14_ng_container_6_tr_1_Template,2,1,"tr",15),b.nd(2,CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template,2,11,"tr",16),b.nd(3,CoreGradesCoursePage_div_14_ng_container_6_tr_3_Template,12,13,"tr",17),b.Bc()),2&e){const e=n.$implicit;b.lc(1),b.Vc("ngIf","leader"===e.itemtype),b.lc(1),b.Vc("ngIf","leader"!==e.itemtype),b.lc(1),b.Vc("ngIf",e.expandable&&e.expanded)}}function CoreGradesCoursePage_div_14_Template(e,n){if(1&e){const e=b.Fc();b.Ec(0,"div",9),b.Ec(1,"table",10),b.Ec(2,"thead"),b.Ec(3,"tr"),b.nd(4,CoreGradesCoursePage_div_14_th_4_Template,3,7,"th",11),b.Dc(),b.Dc(),b.Ec(5,"tbody"),b.nd(6,CoreGradesCoursePage_div_14_ng_container_6_Template,4,3,"ng-container",12),b.Pc(7,"slice"),b.Dc(),b.Dc(),b.Ec(8,"core-infinite-loading",13),b.Mc("action",(function CoreGradesCoursePage_div_14_Template_core_infinite_loading_action_8_listener(n){b.fd(e);return b.Oc().loadMore(n)})),b.Dc(),b.Dc()}if(2&e){const e=b.Oc();b.lc(1),b.qc("summary",e.showSummary),b.lc(3),b.Vc("ngForOf",e.columns),b.lc(2),b.Vc("ngForOf",b.Sc(7,5,e.rows,0,e.rowsOnView)),b.lc(2),b.Vc("enabled",e.rowsOnView<e.rows.length)}}let S=(()=>{class CoreGradesCoursePage{constructor(e,n){var t,r,a;this.route=e,this.element=n,this.columns=[],this.rows=[],this.rowsOnView=0,this.loaded=!1,this.logView=h.a.once((()=>this.performLogView()));try{switch(this.courseId=d.a.getRequiredRouteNumberParam("courseId",{route:e}),this.userId=null!==(t=d.a.getRouteNumberParam("userId",{route:e}))&&void 0!==t?t:i.c.getCurrentSiteUserId(),this.gradeId=d.a.getRouteNumberParam("gradeId",{route:e}),this.expandLabel=g.I.instant("core.expand"),this.collapseLabel=g.I.instant("core.collapse"),this.useLegacyLayout=!i.c.getRequiredCurrentSite().isVersionGreaterEqualThan("4.1"),null!==(r=e.snapshot.data.swipeManagerSource)&&void 0!==r?r:null===(a=e.snapshot.parent)||void 0===a?void 0:a.data.swipeManagerSource){case"courses":this.swipeManager=new CoreGradesCourseCoursesSwipeManager(u.a.getOrCreateSource(p.a,[]));break;case"participants":{const e=d.a.getRouteParam("search");this.swipeManager=new CoreGradesCourseParticipantsSwipeManager(u.a.getOrCreateSource(m.a,[this.courseId,e]))}}}catch(e){return o.a.showErrorModal(e),d.a.back(),void 0}}get showSummary(){return s.a.isMobile||!!this.withinSplitView}ngAfterViewInit(){var e,n;return Object(r.a)(this,void 0,void 0,(function*(){this.withinSplitView=!!(null===(e=this.element.nativeElement.parentElement)||void 0===e?void 0:e.closest("core-split-view")),yield null===(n=this.swipeManager)||void 0===n?void 0:n.start(),yield this.fetchInitialGrades(),this.loaded=!0}))}ngOnDestroy(){var e;null===(e=this.swipeManager)||void 0===e?void 0:e.destroy()}rowAriaLabel(e){if(!e.expandable||!this.showSummary)return;return`${e.expanded?this.collapseLabel:this.expandLabel} ${e.ariaLabel}`}toggleRow(e,n){var t;if(!this.rows||!this.columns)return;e.expanded=null!=n?n:!e.expanded;let r=this.columns.length+(null!==(t=e.colspan)&&void 0!==t?t:0);this.useLegacyLayout&&r--;for(let n=this.rows.indexOf(e)-1;n>=0;n--){const t=this.rows[n];!t.rowspan||!t.colspan||t.colspan!==r||!this.useLegacyLayout&&"leader"!==t.itemtype||this.useLegacyLayout&&t.expandable||(r++,t.rowspan+=e.expanded?1:-1)}}refreshGrades(e){return Object(r.a)(this,void 0,void 0,(function*(){yield _.a.ignoreErrors(a.a.invalidateCourseGradesData(this.courseId,this.userId)),yield _.a.ignoreErrors(this.fetchGrades()),null==e||e.complete()}))}fetchInitialGrades(){return Object(r.a)(this,void 0,void 0,(function*(){try{if(yield this.fetchGrades(),this.gradeId&&this.rows){const e=this.rows.find((e=>e.id==this.gradeId));e&&(this.toggleRow(e,!0),C.a.scrollToElement(this.element.nativeElement,"#grade-"+e.id),this.gradeId=void 0)}}catch(e){o.a.showErrorModalDefault(e,"Error loading course"),this.columns=[],this.rows=[],this.rowsOnView=0}}))}fetchGrades(){var e,n,t,o;return Object(r.a)(this,void 0,void 0,(function*(){const r=yield a.a.getCourseGradesTable(this.courseId,this.userId),i=yield c.a.formatGradesTable(r);this.title=null!==(o=null!==(n=null===(e=this.swipeManager)||void 0===e?void 0:e.getPageTitle())&&void 0!==n?n:null===(t=i.rows[0])||void 0===t?void 0:t.gradeitem)&&void 0!==o?o:g.I.instant("core.grades.grades"),this.columns=i.columns,this.rows=i.rows,this.rowsOnView=this.getRowsOnHeight(),this.totalColumnsSpan=i.columns.reduce(((e,n)=>e+n.colspan),0),this.logView()}))}getRowsOnHeight(){return Math.floor(window.innerHeight/44)}loadMore(e){this.rowsOnView+=this.getRowsOnHeight(),e&&e()}performLogView(){var e;return Object(r.a)(this,void 0,void 0,(function*(){yield _.a.ignoreErrors(a.a.logCourseGradesView(this.courseId,this.userId)),P.a.logEvent({type:P.b.VIEW_ITEM,ws:"gradereport_user_view_grade_report",name:null!==(e=this.title)&&void 0!==e?e:"",data:{id:this.courseId,userid:this.userId,category:"grades"},url:`/grade/report/user/index.php?id=${this.courseId}`+(this.userId!==i.c.getCurrentSiteUserId()?`&userid=${this.userId}`:"")})}))}}return CoreGradesCoursePage.ɵfac=function CoreGradesCoursePage_Factory(e){return new(e||CoreGradesCoursePage)(b.yc(v.a),b.yc(b.r))},CoreGradesCoursePage.ɵcmp=b.sc({type:CoreGradesCoursePage,selectors:[["page-core-grades-course"]],decls:15,vars:12,consts:[["slot","start"],[3,"text"],[3,"core-swipe-navigation"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-chart-bar",3,"message",4,"ngIf"],["class","core-grades-container",4,"ngIf"],["icon","fas-chart-bar",3,"message"],[1,"core-grades-container"],[1,"core-grades-table"],["class","ion-text-start",3,"id","ion-hide-md-down",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"enabled","action"],[1,"ion-text-start",3,"id"],[4,"ngIf"],[3,"class","core-grades-grade-clickable","id","ariaButtonClick",4,"ngIf"],[3,"id","class",4,"ngIf"],[1,"core-grades-table-leader"],[3,"id","ariaButtonClick"],["class","core-grades-table-category",4,"ngIf"],[1,"core-grades-table-gradeitem","ion-text-start"],["aria-hidden","true","slot","start","name","fas-chevron-right","class","expandable-status-icon",3,"expandable-status-icon-expanded",4,"ngIf"],["slot","start",3,"name",4,"ngIf"],["slot","start","class","core-module-icon",3,"src","alt",4,"ngIf"],["slot","start",3,"modicon","modname",4,"ngIf"],[3,"innerHTML"],[1,"core-grades-table-category"],["aria-hidden","true","slot","start","name","fas-chevron-right",1,"expandable-status-icon"],["slot","start",3,"name"],["slot","start",1,"core-module-icon",3,"src","alt"],["slot","start",3,"modicon","modname"],[3,"class","ion-hide-md-down","innerHTML",4,"ngIf"],["class","ion-text-start core-grades-table-feedback",3,"ion-hide-md-down",4,"ngIf"],[3,"ion-hide-md-down","class",4,"ngIf"],[1,"ion-text-start","core-grades-table-feedback"],["collapsible-item","","contextLevel","course",3,"text","contextInstanceId"],[3,"name",4,"ngIf"],[3,"name"],[3,"id"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap"],[1,"item-heading"]],template:function CoreGradesCoursePage_Template(e,n){1&e&&(b.Ec(0,"ion-header"),b.Ec(1,"ion-toolbar"),b.Ec(2,"ion-buttons",0),b.zc(3,"ion-back-button",1),b.Pc(4,"translate"),b.Dc(),b.Ec(5,"ion-title"),b.Ec(6,"h1"),b.pd(7),b.Dc(),b.Dc(),b.Dc(),b.Dc(),b.Ec(8,"ion-content",2),b.Ec(9,"ion-refresher",3),b.Mc("ionRefresh",(function CoreGradesCoursePage_Template_ion_refresher_ionRefresh_9_listener(e){return n.refreshGrades(e.target)})),b.zc(10,"ion-refresher-content",4),b.Pc(11,"translate"),b.Dc(),b.Ec(12,"core-loading",5),b.nd(13,CoreGradesCoursePage_core_empty_box_13_Template,2,3,"core-empty-box",6),b.nd(14,CoreGradesCoursePage_div_14_Template,9,9,"div",7),b.Dc(),b.Dc()),2&e&&(b.lc(3),b.Vc("text",b.Qc(4,8,"core.back")),b.lc(4),b.qd(n.title),b.lc(1),b.Vc("core-swipe-navigation",n.swipeManager),b.lc(1),b.Vc("disabled",!n.columns||!n.rows),b.lc(1),b.Wc("pullingText",b.Qc(11,10,"core.pulltorefresh")),b.lc(2),b.Vc("hideUntil",n.loaded),b.lc(1),b.Vc("ngIf",!n.rows.length),b.lc(1),b.Vc("ngIf",n.rows.length))},directives:[f.C,f.Ab,f.m,f.h,f.i,f.yb,O.a,f.v,M.a,f.bb,f.cb,w.a,I.t,x.a,I.s,G.a,T.a,f.D,y.a,E.a,V.a,k.a,f.P,f.I,f.O],pipes:[D.d,I.E],styles:["[_nghost-%COMP%]{--header-background:var(--white);--odd-cell-background:var(--light);--odd-cell-hover:var(--gray-200);--even-cell-background:var(--white);--even-cell-hover:var(--light);--icon-color:var(--gray-500);--border-color:var(--stroke)}[_nghost-%COMP%]   .odd[_ngcontent-%COMP%]{--cell-background:var(--odd-cell-background);--cell-hover:var(--odd-cell-hover)}[_nghost-%COMP%]   .even[_ngcontent-%COMP%]{--cell-background:var(--even-cell-background);--cell-hover:var(--even-cell-hover)}html.dark[_nghost-%COMP%], html.dark   [_nghost-%COMP%]{--header-background:var(--gray-900);--odd-cell-background:var(--gray-800);--odd-cell-hover:var(--gray-600);--even-cell-background:var(--gray-900);--even-cell-hover:var(--gray-700);--icon-color:var(--gray-200)}.core-grades-table[_ngcontent-%COMP%]{border-collapse:collapse;line-height:20px;width:100%;font-size:16px;color:var(--ion-text-color)}.core-grades-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--border-color)}.core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{-webkit-padding-end:8px;padding-inline-end:8px;padding-top:8px;padding-bottom:8px;vertical-align:top;white-space:normal;text-align:start}.core-grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:bottom;font-weight:700;background-color:var(--header-background)}.core-grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{-webkit-padding-start:24px;padding-inline-start:24px}.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400}.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.core-bold[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:inherit}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{-webkit-padding-start:4px;padding-inline-start:4px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]{font-weight:700}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem.column-itemname[_ngcontent-%COMP%]{-webkit-padding-start:0;padding-inline-start:0}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;height:16px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   core-mod-icon[_ngcontent-%COMP%]{--padding:0px;--size:16px;background:transparent;--filter:var(--module-icon-filter)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--icon-color)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{-webkit-margin-start:4px;margin-inline-start:4px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon[_ngcontent-%COMP%]{font-size:var(--text-size);-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:2px;margin-inline-end:2px;transition:transform .2s ease-in-out}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon.expandable-status-icon-expanded[_ngcontent-%COMP%]{transform:var(--rotate-expandable)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]{-webkit-padding-start:4px;padding-inline-start:4px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]   .no-overflow[_ngcontent-%COMP%]{overflow:auto}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-grade[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{-webkit-padding-end:4px;padding-inline-end:4px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-leader[_ngcontent-%COMP%]{width:0}.core-grades-table[_ngcontent-%COMP%]   .ion-no-border[_ngcontent-%COMP%]{border:0!important}.core-grades-table[_ngcontent-%COMP%]   .dimmed_text[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{opacity:.7}.core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   th[aria-current=page][_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   th[aria-current=page][_ngcontent-%COMP%]{background-color:var(--cell-background)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]{cursor:pointer}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   th[aria-current=page][_ngcontent-%COMP%]{background-color:var(--cell-hover)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{height:var(--a11y-min-target-size);vertical-align:middle}.core-grades-table[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]::part(native), .core-grades-table[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background-color:initial}.core-grades-table.summary[_ngcontent-%COMP%]   .ion-hide-md-down[_ngcontent-%COMP%]{display:none;opacity:0}@media (max-width:767.98px){.core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85em}}"]}),CoreGradesCoursePage})();class CoreGradesCourseCoursesSwipeManager extends l.a{constructor(e){super(e)}getPageTitle(){const e=this.getSelectedItem();return null==e?void 0:e.courseFullName}}class CoreGradesCourseParticipantsSwipeManager extends l.a{constructor(e){super(e)}getPageTitle(){const e=this.getSelectedItem();return null==e?void 0:e.fullname}getSelectedItemPathFromRoute(e){return e.params.userId}}}}]);